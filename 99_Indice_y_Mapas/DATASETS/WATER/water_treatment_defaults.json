{
  "dataset_id": "water_treatment_defaults",
  "version": "1.0",
  "scope": {
    "layer_1_secure": [
      "Conversión de reportes de agua (ppm/mg-L) a alcalinidad equivalente y RA aproximada",
      "Aportes iónicos por sales comunes (ppm por g/L) para construir perfiles objetivos",
      "Neutralización de alcalinidad para agua de lavado (sparge) con ácido láctico 85% o fosfórico 85% (aprox.)"
    ],
    "layer_2_optional": [
      "Estimación teórica de pH de mash (solo orientativa; requiere validación con medición real)",
      "Modelos específicos por malta/color/RA (se agregan cuando tengas datos/experiencia propia)"
    ]
  },
  "units": {
    "ions_ppm": "mg/L",
    "alkalinity_as_CaCO3_ppm": "mg/L as CaCO3",
    "volume_L": "L",
    "salt_mass_g": "g",
    "acid_volume_mL": "mL"
  },
  "conversions": {
    "hco3_ppm_to_alkalinity_as_CaCO3_ppm_factor": 0.819672131147541,
    "alkalinity_as_CaCO3_ppm_to_hco3_ppm_factor": 1.22,
    "meq_per_L_from_alkalinity_as_CaCO3_ppm": "meq/L = alkalinity_as_CaCO3_ppm / 50"
  },
  "ions_supported": [
    "Ca",
    "Mg",
    "Na",
    "Cl",
    "SO4",
    "HCO3",
    "Alkalinity_as_CaCO3"
  ],
  "salts": [
    {
      "id": "gypsum",
      "name": "Sulfato de calcio (CaSO4·2H2O)",
      "grams_per_L_to_ppm": {
        "Ca": 232.6,
        "SO4": 558.0
      },
      "notes": "Aproximación por estequiometría. Puede variar levemente según hidratación/pureza."
    },
    {
      "id": "calcium_chloride",
      "name": "Cloruro de calcio (CaCl2·2H2O)",
      "grams_per_L_to_ppm": {
        "Ca": 272.0,
        "Cl": 482.0
      },
      "notes": "Aproximación por estequiometría (dihidrato)."
    },
    {
      "id": "epsom_salt",
      "name": "Sulfato de magnesio (MgSO4·7H2O)",
      "grams_per_L_to_ppm": {
        "Mg": 98.6,
        "SO4": 389.0
      },
      "notes": "Aproximación por estequiometría (heptahidrato)."
    },
    {
      "id": "table_salt",
      "name": "Cloruro de sodio (NaCl)",
      "grams_per_L_to_ppm": {
        "Na": 393.0,
        "Cl": 607.0
      },
      "notes": "Aproximación por estequiometría."
    },
    {
      "id": "baking_soda",
      "name": "Bicarbonato de sodio (NaHCO3)",
      "grams_per_L_to_ppm": {
        "Na": 274.0,
        "HCO3": 726.0
      },
      "notes": "Aproximación por estequiometría."
    },
    {
      "id": "pickling_lime",
      "name": "Hidróxido de calcio (Ca(OH)2)",
      "grams_per_L_to_ppm": {
        "Ca": 540.0,
        "Alkalinity_as_CaCO3": 1350.0
      },
      "notes": "Alcalinidad como CaCO3 equivalente (aprox.). Usar con extremo cuidado."
    }
  ],
  "acids": [
    {
      "id": "lactic_85",
      "name": "Ácido láctico 85% (w/w)",
      "type": "monoprotic",
      "assumptions": {
        "density_g_per_mL": 1.206,
        "wt_fraction": 0.85,
        "mw_g_per_mol": 90.078,
        "effective_eq_per_mol": 1.0
      },
      "mEq_per_mL_approx": 11.38,
      "notes": "Aproximación para neutralizar alcalinidad (sparge). Validar con medición real de pH."
    },
    {
      "id": "phosphoric_85",
      "name": "Ácido fosfórico 85% (w/w)",
      "type": "polyprotic",
      "assumptions": {
        "density_g_per_mL": 1.685,
        "wt_fraction": 0.85,
        "mw_g_per_mol": 97.995
      },
      "mEq_per_mL_approx_effective_1eq": 14.62,
      "mEq_per_mL_approx_effective_2eq": 29.23,
      "default_effective_eq_per_mol": 1.0,
      "notes": "Fosfórico es triprótico; para uso cervecero se usa un 'equivalente efectivo'. Por defecto 1 eq/mol para cálculo conservador."
    },
    {
      "id": "citric_variable",
      "name": "Ácido cítrico (variable: polvo o solución)",
      "type": "polyprotic",
      "required_user_inputs": [
        "forma (polvo/solución)",
        "pureza o concentración",
        "densidad si es solución"
      ],
      "notes": "No se fija por defecto porque varía mucho según presentación. Se habilita en Capa 2 cuando definamos tu insumo real."
    }
  ],
  "core_formulas": {
    "residual_alkalinity_RA_as_CaCO3_ppm": "RA ≈ Alkalinity_as_CaCO3 - (Ca/3.5 + Mg/7)  [todas en ppm]",
    "acid_mEq_needed_for_sparge": "mEq = (Alk_in - Alk_target) * V(L) / 50",
    "acid_mL_needed": "mL = mEq / (acid_mEq_per_mL)"
  },
  "defaults": {
    "sparge_alkalinity_target_as_CaCO3_ppm": 30,
    "mash_sparge_split": {
      "mash_fraction": 0.6,
      "sparge_fraction": 0.4
    }
  },
  "warnings": [
    "Los cálculos son aproximaciones. El pH real depende de malta, temperatura, CO2 disuelto, y otros factores.",
    "Para decisiones operativas, validar con medición (pH-metro) y ajustar con el método que uses en planta."
  ]
}